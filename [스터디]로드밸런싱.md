## 인터넷 사용의 증가

인터넷의 시대가 도래하면서 자연스럽게 폭발적인 트래픽 증가로 이어졌다.
![](https://images.velog.io/images/jins/post/65518e26-5c5b-4851-812f-156e7894a9ee/image.png)

[출처](https://nscreenmedia.com/video-bandwidth-growth-cisco-vni-2018/181202-global-internet-traffic-by-device-type/)

그래서 아무리 성능이 뛰어난 서버라고 해도 모든 트래픽을 감당해낼 수 없게 되었다. 그래서 자연스럽게 서버를 추가하고 여러 대의 서버에 동일한 데이터를 저장해 수많은 트래픽을 효과적으로 분산하게 되었다.



### 2가지의 방법

#### Scale-Up

- 서버의 자체의 성능을 향상

#### Scale-out

- 작은 서버를 여러대 사용 
(여러 대의 서버로 트래픽을 균등하게 분산해주는 로드밸런싱 무조건 필요!)

![img](https://post-phinf.pstatic.net/MjAxOTEyMTBfMjk1/MDAxNTc1OTU1MDI2NTY4.Zxj8nWGb6G6jtHDAZPPDf-dPZnpb_hsd7ydWw5lW7vAg.AucOXPJnmLyGiHr8KpVD9Dsy59FsWv5p7qJnSyW_YFAg.JPEG/%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1_%EC%8A%A4%EC%BC%80%EC%9D%BC.jpg?type=w1200)

[출처](https://m.post.naver.com/viewer/postView.nhn?volumeNo=27046347&memberNo=2521903)




> 쏟아지는 트래픽을 여러 대의 서버로 분산해주는 기술이 없다면 어느 한 곳의 서버에 모든 트래픽이 몰리는 상황이 발생할 것이다. 

하지만, 단순히 다수의 서버를 구축해 운영하면 모든 클라이언트의 요청에 일관성 있게 응답할 수 있을까?

그래서 나온 기술이 로드(부하)밸런싱(분산) 이다. 

**로드 밸런서**는 서버에 가해지는 장치나 기술을 통칭한다. 

(길이 너무막혀 진행을 할 수 없을때, 교통정리를 하는 경찰이라고 생각 )



![What is Server Load Balancing? Definition &amp; Related FAQs | Avi Networks](https://avinetworks.com/wp-content/uploads/2018/11/server-load-balancing-diagram.png)

[출처](https://avinetworks.com/wp-content/uploads/2018/11/server-load-balancing-diagram.png)
<br>
### 로드밸런싱은 항상 필요할까?

- 아니다

서비스 제공 초기 단계라면 서버 한대로 여러 요청에 응답하는 것이 가능하다.
하지만, 클라이언트의 수가 늘어나면 기존의 서버만으로 정상적인 서비스가 불가능하다.



## 로드밸런싱 작동 알고리즘

### Round Robin Method

- 서버에 들어온 요청을 순서대로 돌아가며 배정하는 방식
- 요청을 순서대로 분배하기 때문에 여러 대의 서버가 동일한 스펙을 갖고 있고, 서버와의 연결이 오래 지속되지 않는 경우에 활용에 적합

### Weighted Round Robin Method

- A, B 서버가 있다고 생각할때, A의 가중치는 6 B의 가중치는 2일때 A서버에 6개 주고 B에는 2를 주는 기술

### IP Hash Method

- 사용자의 IP를 해싱해 로드를 분해
- 클라이언트의 IP 주소를 특정 서버로 매핑하여 요청을 처리하는 방식.

### Least Connection Method

- 요청이 들어온 시점에 가장 적은 연결상태를 보이는 서버에 우선적으로 트래픽을 분배

### Least Response Time Method

- 서버의 현재 상태와 응답시간을 고려해, 적은 연결상태와 짧은 응답시간을 보이는 서버에 우선적으로 로드를 배분

### 이외에도 다양한 방법들이 있다.

<br><br>
## 그 외에도 다양한 기능
- Health Check
	- 서버의 Health를 주기적으로 Check하여 장애 여부를 판단
    
- NAT(Network Address Translation)
	- IP주소를 변환
    
- DSR(Direct Server Routing)
	- 서버에서 클라이언트로 되돌아가는 경우, 네트워크 장비나 로드밸런서를 거치지 않고 바로 클라이언트를 찾아가도록 (로드밸런서의 부하 줄이기)
    
- etc...

### 어떤 로드밸런서 사용?

- OSI 7계층 중 L2, L3, L4, L7 로드밸런서가 있다.

하지만, 로드밸런싱에는 L4 로드밸런서와 L7 로드밸런서가 가장 많이 활용

>L4 로드밸런서부터 포트 정보를 바탕으로 로드를 분산하는 것이 가능하다.
(**한 대의 서버**에 각기 **다른 포트 번호**를 부여하여 **다수의 서버 프로그램을 운영**하는 경우 최소 L4 로드밸런서 이상 사용해야 함)

### L4 vs L7 

![](https://images.velog.io/images/jins/post/6e77fc71-2103-4fc2-8d65-87d732109f07/image.png)

[출처](https://m.post.naver.com/viewer/postView.nhn?volumeNo=27046347&memberNo=2521903)
<br><br>
### 참고
- [참고 1](https://m.post.naver.com/viewer/postView.nhn?volumeNo=27046347&memberNo=2521903)
- [참고 2](https://dev.classmethod.jp/articles/load-balancing-types-and-algorithm/)
- [참고 3](http://wiki.hash.kr/index.php/%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1)
- [참고 4](https://www.stevenjlee.net/2020/06/30/%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%EC%9D%98-%EB%B6%80%ED%95%98%EB%B6%84%EC%82%B0-%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1-load-balancing-%EA%B7%B8/)